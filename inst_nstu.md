# Установка XRT на кластер НГТУ

## Создание сервера
1. Зайдите в [панель управления](https://cloud.nstu.ru/ui/servers) облачной платформы НГТУ с логином и паролем от 
сайта университета.
2. В разделе "Серверы" нажмите "Создать виртуальный сервер": имя любое, шаблон Debian Linux 11 Minimal; 
время работы, vCPU, и память максимальные.
3. После создания, выберите сервер в списке, нажмите "Запустить"
4. После запуска в разделе "Сети" нажмите "Опубликовать сервер", "Тип публикации" — "Управление SSH", 
остальные параметры по умолчанию.
5. Посмотрите на "Внешний адрес" опубликованного сервера: он должен быть вида `ssh.cloud.nstu.ru:порт`, 
порт — это номер порта, он понадобится нам далее.

## Конфигурация сервера
### Соединение с удалённым сервером (Linux/Mac)
1. Откройте терминал, наберите `ssh -p порт root@ssh.cloud.nstu.ru`. Система может спросить, доверять ли хосту 
(введите yes), а затем запросит пароль. Пароль для пользователя root по умолчанию написан 
[здесь](https://cloud.nstu.ru/wiki/управление_виртуальным_сервером), в самом низу страницы. Как только вы залогинитесь, 
система потребует чтобы вы сменили пароль.

### Соединение с удалённым сервером (Windows)
1. 
    a. Скачайте и установите программу [PuTTY](https://www.putty.org), позволяющую соединяться с удалёнными 
    компьютерами по SSH.

    b. ваывывм

### Установив соединение с удалённым компьютером
**ВАЖНО!** Будьте предельно аккуратны, работая под пользователем root. 
Root обладает всеми правами в системе, и совершить непоправимую ошибку очень легко — например, 
удалить или повредить файлы ОС. 
В рамках данного туториала пользователь root понадобится вам всего один раз.
Не теряйте пароль от пользователя root, но и не работайте под ним.
2. Поскольку работать под root небезопасно, первое, что нужно сделать — это зарегистрировать нового пользователя с 
меньшим количеством прав. 
Чтобы добавить пользователя, используйте команду `useradd -m имя -s /bin/bash -G sudo`.
Затем пользователю нужно установить пароль командой `passwd имя`.
3. Смените пользователя на вновь созданного командой `su имя` и перейдите в домашнюю директорию командой `cd ~`. 
По умолчанию домашняя директория будет пустой, можно это проверить командой `ls`.
4. Обновите систему и системные пакеты командами `sudo apt-get update`, а затем `sudo apt-get upgrade`. 
После этого закройте терминал и из панели управления облачной платформы перезагрузите сервер.

## Установка ПО
1. Установите соединение с сервером под новым пользователем. Для команды ssh замените root на имя нового 
пользователя, для PuTTY ...
2. В системе уже должен быть установлен `Python`, можно проверить его присутствие / версию командой `python3 --version`.
3. Следующий шаг — создание виртуального окружения. Виртуальное окружение `Python` это копия основного интерпретатора
со своей конфигурацией и своим набором пакетов. 
Смысл виртуальных окружений в том, что можно параллельно иметь несколько версий интерпретатора с разными 
(потенциально конфликтующими) наборами пакетов и программ. 
При этом активируя виртуальное окружение можно использовать каждое из них как отдельный самостоятельный интерпретатор.
Сначала нужно установить пакет `venv` командой `sudo apt-get install python3-venv`, 
а затем создать само окружение командой `python3 -m venv xrt-venv`. 
Последняя команда создаст в текущей директории новую папку `xrt-venv`, в которой и будут находиться файлы 
интерпретатора виртуального окружения.
4. Активируйте вновь созданное виртуальное окружение командой `sudo apt-get install git` `sudo apt-get install python3-pyopencl` `sudo apt-get install python3-pip` `source xrt-venv/bin/activate`.
5.  `pip3 install wheel` `pip3 install xrt pyopencl` intel-opencl-icd